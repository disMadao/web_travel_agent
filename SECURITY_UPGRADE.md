# ğŸ”’ å®‰å…¨å‡çº§æŒ‡å—

## ğŸ“‹ æ›´æ–°å†…å®¹

æˆ‘ä»¬å·²ç»å°†**æ‰€æœ‰æ•æ„Ÿçš„ API Key ç§»åˆ°äº†åç«¯**ï¼Œå¤§å¹…æå‡äº†åº”ç”¨çš„å®‰å…¨æ€§ï¼

---

## âœ… ç°åœ¨å‰ç«¯åªéœ€è¦ä¸€ä¸ªé…ç½®

åˆ›å»º `frontend/.env`ï¼š

```bash
# åªéœ€è¦è¿™ä¸€ä¸ªé…ç½®ï¼
VITE_API_BASE_URL=http://localhost:8000/api/v1
```

**å°±è¿™ä¹ˆç®€å•ï¼** ğŸ‰

---

## ğŸ” æ‰€æœ‰æ•æ„Ÿé…ç½®éƒ½åœ¨åç«¯

ç¡®ä¿ `backend/.env` åŒ…å«ï¼š

```bash
# Supabaseï¼ˆæ•°æ®åº“ï¼‰
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_service_role_key

# DeepSeek AIï¼ˆè¡Œç¨‹è§„åˆ’ï¼‰
OPENAI_API_KEY=your_deepseek_api_key
OPENAI_BASE_URL=https://api.deepseek.com/v1
OPENAI_MODEL=deepseek-chat

# é«˜å¾·åœ°å›¾ï¼ˆåœ°ç†ç¼–ç ã€POI æœç´¢ï¼‰
AMAP_API_KEY=your_amap_api_key

# åº”ç”¨é…ç½®
APP_ENV=development
SECRET_KEY=your_secret_key_change_this_in_production
API_PREFIX=/api/v1
CORS_ORIGINS_STR=["http://localhost:5173", "http://localhost:3000"]
```

---

## ğŸ“¦ å®‰è£…æ–°ä¾èµ–

### å‰ç«¯

```bash
cd frontend

# åˆ é™¤æ—§ä¾èµ–ï¼Œå®‰è£…æ–°ä¾èµ–
npm install
```

**æ–°å¢çš„ä¾èµ–**ï¼š
- `leaflet` - å¼€æºåœ°å›¾åº“
- `react-leaflet` - React å°è£…
- `@types/leaflet` - TypeScript ç±»å‹

**ç§»é™¤çš„ä¾èµ–**ï¼š
- `@amap/amap-jsapi-loader` - ä¸å†éœ€è¦
- `@supabase/supabase-js` - å‰ç«¯ä¸å†ç›´æ¥ä½¿ç”¨

### åç«¯

```bash
cd backend

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.\venv\Scripts\activate  # Windows
# æˆ–
source venv/bin/activate  # macOS/Linux

# ä¾èµ–å·²åŒ…å«åœ¨ requirements.txt ä¸­
pip install -r requirements.txt
```

---

## ğŸš€ å¯åŠ¨åº”ç”¨

### 1. å¯åŠ¨åç«¯

```bash
cd backend
python main.py
```

ä½ åº”è¯¥çœ‹åˆ°ï¼š

```
ğŸš€ å¯åŠ¨ AI æ™ºèƒ½æ—…è¡ŒåŠ©æ‰‹ åç«¯æœåŠ¡
ğŸ“¡ API æ–‡æ¡£: http://localhost:8000/docs
ğŸ” å¥åº·æ£€æŸ¥: http://localhost:8000/health
ğŸŒ ç¯å¢ƒ: development
ğŸ¤– AI æ¨¡å‹: deepseek-chat
```

### 2. å¯åŠ¨å‰ç«¯

```bash
cd frontend
npm run dev
```

è®¿é—®ï¼š`http://localhost:5173`

---

## ğŸ—ºï¸ åœ°å›¾åŠŸèƒ½å˜åŒ–

| åŠŸèƒ½ | ä¹‹å‰ | ç°åœ¨ |
|------|------|------|
| **åœ°å›¾æ˜¾ç¤º** | é«˜å¾·åœ°å›¾ JS API | OpenStreetMapï¼ˆå…è´¹ï¼‰ |
| **æ ‡è®°æ™¯ç‚¹** | âœ… | âœ… |
| **ç»˜åˆ¶è·¯çº¿** | âœ… | âœ… |
| **åœ°ç†ç¼–ç ** | âŒ | âœ… åç«¯ API |
| **POI æœç´¢** | âŒ | âœ… åç«¯ API |
| **éœ€è¦ API key** | âœ… å‰ç«¯æš´éœ² | âŒ å®Œå…¨åœ¨åç«¯ |

---

## ğŸ“ æ–°å¢çš„åç«¯ API

### 1. åœ°ç†ç¼–ç ï¼ˆåœ°å€ â†’ åæ ‡ï¼‰

```javascript
POST /api/v1/maps/geocode
{
  "address": "å¤©å®‰é—¨",
  "city": "åŒ—äº¬"
}

// è¿”å›
{
  "longitude": 116.397428,
  "latitude": 39.90923,
  "formatted_address": "åŒ—äº¬å¸‚ä¸œåŸåŒºå¤©å®‰é—¨"
}
```

### 2. POI æœç´¢

```javascript
POST /api/v1/maps/search
{
  "keyword": "æ•…å®«",
  "city": "åŒ—äº¬",
  "limit": 10
}

// è¿”å›æ™¯ç‚¹åˆ—è¡¨
[
  {
    "name": "æ•…å®«åšç‰©é™¢",
    "address": "...",
    "longitude": 116.397,
    "latitude": 39.917
  }
]
```

### 3. è·¯çº¿è§„åˆ’

```javascript
POST /api/v1/maps/route
{
  "origin_lng": 116.397428,
  "origin_lat": 39.90923,
  "dest_lng": 116.404,
  "dest_lat": 39.915
}

// è¿”å›
{
  "distance": 1234.5,  // ç±³
  "duration": 600      // ç§’
}
```

---

## âœ¨ å‡çº§ä¼˜åŠ¿

### å®‰å…¨æ€§ ğŸ”’
- âœ… **æ‰€æœ‰æ•æ„Ÿ API Key éƒ½åœ¨åç«¯**ï¼Œå‰ç«¯å®Œå…¨ä¸æš´éœ²
- âœ… ç”¨æˆ·æ— æ³•é€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·çœ‹åˆ°ä»»ä½•å¯†é’¥
- âœ… å¯ä»¥åœ¨åç«¯æ·»åŠ æƒé™æ§åˆ¶ã€é¢‘ç‡é™åˆ¶

### æˆæœ¬ ğŸ’°
- âœ… **OpenStreetMap å®Œå…¨å…è´¹**ï¼Œæ— ä½¿ç”¨é™åˆ¶
- âœ… é«˜å¾·åœ°å›¾åªåœ¨å¿…è¦æ—¶ï¼ˆåœ°ç†ç¼–ç ã€è·¯çº¿è§„åˆ’ï¼‰æ‰è°ƒç”¨
- âœ… å¯ä»¥åœ¨åç«¯ç¼“å­˜ç»“æœï¼Œå‡å°‘ API è°ƒç”¨

### çµæ´»æ€§ ğŸ¯
- âœ… å¯ä»¥è½»æ¾åˆ‡æ¢åœ°å›¾ç“¦ç‰‡æœåŠ¡å•†
- âœ… å¯ä»¥è‡ªå®šä¹‰åœ°å›¾æ ·å¼å’Œä¸»é¢˜
- âœ… å¯ä»¥æ·»åŠ æ—¥å¿—è®°å½•å’Œç›‘æ§

---

## ğŸ” éªŒè¯å‡çº§æˆåŠŸ

### 1. æ£€æŸ¥å‰ç«¯é…ç½®

æ‰“å¼€ `frontend/src/config/index.ts`ï¼Œåº”è¯¥åªæœ‰ï¼š

```typescript
export const config = {
  api: {
    baseUrl: import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000/api/v1',
  },
}
```

**æ²¡æœ‰**ä»»ä½• `amap` æˆ– `supabase` é…ç½®ï¼âœ…

### 2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°

æ‰“å¼€åº”ç”¨ï¼ŒæŒ‰ F12 æŸ¥çœ‹ Network æ ‡ç­¾ï¼š
- âŒ **ä¸åº”è¯¥**çœ‹åˆ°ä»»ä½•å¯¹ `restapi.amap.com` çš„è¯·æ±‚
- âŒ **ä¸åº”è¯¥**çœ‹åˆ°ä»»ä½•å¯¹ `supabase.co` çš„ç›´æ¥è¯·æ±‚
- âœ… **åº”è¯¥**åªçœ‹åˆ°å¯¹ `localhost:8000/api/v1` çš„è¯·æ±‚
- âœ… **åº”è¯¥**çœ‹åˆ°å¯¹ OpenStreetMap ç“¦ç‰‡çš„è¯·æ±‚ï¼ˆ`tile.openstreetmap.org`ï¼‰

### 3. æµ‹è¯•åœ°å›¾åŠŸèƒ½

1. åˆ›å»ºä¸€ä¸ªæ–°è¡Œç¨‹
2. æŸ¥çœ‹è¡Œç¨‹è¯¦æƒ…ï¼Œåœ°å›¾åº”è¯¥æ­£å¸¸æ˜¾ç¤º
3. æ™¯ç‚¹æ ‡è®°å’Œè·¯çº¿åº”è¯¥éƒ½èƒ½çœ‹åˆ°
4. ç‚¹å‡»æ ‡è®°ï¼Œå¼¹å‡ºçª—å£åº”è¯¥æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [åœ°å›¾è¿ç§»è¯¦ç»†è¯´æ˜](docs/MAP_MIGRATION.md) - æŠ€æœ¯ç»†èŠ‚å’Œ API æ–‡æ¡£
- [é…ç½®æŒ‡å—](docs/CONFIG_GUIDE.md) - å®Œæ•´çš„é…ç½®è¯´æ˜
- [æ•…éšœæ’é™¤](docs/TROUBLESHOOTING.md) - å¸¸è§é—®é¢˜è§£å†³

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„åº”ç”¨ï¼š
- âœ… **æ›´å®‰å…¨** - æ‰€æœ‰å¯†é’¥éƒ½åœ¨åç«¯
- âœ… **æ›´ä¾¿å®œ** - ä½¿ç”¨å…è´¹çš„ OpenStreetMap
- âœ… **æ›´çµæ´»** - å¯ä»¥è‡ªç”±åˆ‡æ¢åœ°å›¾æœåŠ¡
- âœ… **æ›´å¯æ§** - æ‰€æœ‰ API è°ƒç”¨éƒ½ç»è¿‡åç«¯

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ–‡æ¡£æˆ–æ Issueï¼ğŸš€

