# åœ°å›¾æœåŠ¡è¿ç§»è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

ä¸ºäº†æé«˜å®‰å…¨æ€§ï¼Œæˆ‘ä»¬å°†é«˜å¾·åœ°å›¾ API key ä»å‰ç«¯ç§»åˆ°äº†åç«¯ï¼Œå¹¶é‡‡ç”¨äº†**åç«¯ä»£ç† + å¼€æºåœ°å›¾**çš„æ¶æ„ã€‚

---

## ğŸ”’ å®‰å…¨æ€§æå‡

### âŒ ä¹‹å‰çš„æ¶æ„ï¼ˆä¸å®‰å…¨ï¼‰

```
å‰ç«¯ â”€â”€â”€ é«˜å¾·åœ°å›¾ Key â”€â”€â†’ é«˜å¾·åœ°å›¾ API
        â†‘ æš´éœ²åœ¨æµè§ˆå™¨ä¸­
```

**é—®é¢˜**ï¼š
- ä»»ä½•äººæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·å°±èƒ½çœ‹åˆ° API key
- åˆ«äººå¯ä»¥ç›—ç”¨ä½ çš„ keyï¼Œäº§ç”Ÿè´¹ç”¨
- æ— æ³•æ§åˆ¶ä½¿ç”¨é¢‘ç‡å’ŒèŒƒå›´

### âœ… ç°åœ¨çš„æ¶æ„ï¼ˆå®‰å…¨ï¼‰

```
å‰ç«¯ â”€â”€â†’ OpenStreetMapï¼ˆå…è´¹ï¼Œæ— éœ€ keyï¼‰
å‰ç«¯ â”€â”€â†’ åç«¯ API â”€â”€â†’ é«˜å¾·åœ°å›¾ API
                â†‘ Key åªåœ¨æœåŠ¡å™¨
```

**ä¼˜ç‚¹**ï¼š
- âœ… **é«˜å¾· key å®Œå…¨ä¸æš´éœ²**ç»™å‰ç«¯
- âœ… åœ°å›¾æ˜¾ç¤ºä½¿ç”¨ **OpenStreetMap**ï¼ˆå¼€æºï¼Œå…è´¹ï¼Œæ— éœ€ keyï¼‰
- âœ… éœ€è¦é«˜å¾·æœåŠ¡æ—¶ï¼ˆåœ°ç†ç¼–ç ã€è·¯çº¿è§„åˆ’ï¼‰é€šè¿‡åç«¯ä»£ç†
- âœ… å¯ä»¥åœ¨åç«¯æ§åˆ¶è°ƒç”¨é¢‘ç‡ã€æƒé™ã€æ—¥å¿—

---

## ğŸ—ºï¸ å‰ç«¯åœ°å›¾æ˜¾ç¤º

### æŠ€æœ¯æ ˆ
- **Leaflet**: å¼€æºåœ°å›¾åº“ï¼Œè½»é‡çº§ï¼ŒåŠŸèƒ½å¼ºå¤§
- **React-Leaflet**: Leaflet çš„ React ç»„ä»¶å°è£…
- **OpenStreetMap**: å…è´¹çš„åœ°å›¾ç“¦ç‰‡æœåŠ¡ï¼Œæ— éœ€æ³¨å†Œæˆ– API key

### å®‰è£…ä¾èµ–

```bash
cd frontend
npm install leaflet react-leaflet
npm install -D @types/leaflet
```

### ä½¿ç”¨ç¤ºä¾‹

```tsx
import MapView from '@/components/MapView'

<MapView
  attractions={attractions}
  accommodations={accommodations}
  zoom={12}
/>
```

---

## ğŸ”§ åç«¯åœ°å›¾æœåŠ¡

### å¯ç”¨çš„ API ç«¯ç‚¹

#### 1. åœ°ç†ç¼–ç ï¼ˆåœ°å€ â†’ ç»çº¬åº¦ï¼‰

```bash
POST /api/v1/maps/geocode
Content-Type: application/json
Authorization: Bearer {token}

{
  "address": "å¤©å®‰é—¨",
  "city": "åŒ—äº¬"
}
```

**å“åº”**ï¼š
```json
{
  "longitude": 116.397428,
  "latitude": 39.90923,
  "formatted_address": "åŒ—äº¬å¸‚ä¸œåŸåŒºå¤©å®‰é—¨"
}
```

#### 2. POI æœç´¢ï¼ˆæ™¯ç‚¹ã€é¤å…ç­‰ï¼‰

```bash
POST /api/v1/maps/search
Content-Type: application/json
Authorization: Bearer {token}

{
  "keyword": "æ•…å®«",
  "city": "åŒ—äº¬",
  "limit": 10
}
```

**å“åº”**ï¼š
```json
[
  {
    "name": "æ•…å®«åšç‰©é™¢",
    "address": "åŒ—äº¬å¸‚ä¸œåŸåŒºæ™¯å±±å‰è¡—4å·",
    "longitude": 116.397,
    "latitude": 39.917,
    "type": "æ—…æ¸¸æ™¯ç‚¹"
  }
]
```

#### 3. è·¯çº¿è§„åˆ’

```bash
POST /api/v1/maps/route
Content-Type: application/json
Authorization: Bearer {token}

{
  "origin_lng": 116.397428,
  "origin_lat": 39.90923,
  "dest_lng": 116.404,
  "dest_lat": 39.915,
  "strategy": 0
}
```

**å“åº”**ï¼š
```json
{
  "distance": 1234.5,  // ç±³
  "duration": 600,     // ç§’
  "strategy": "é€Ÿåº¦ä¼˜å…ˆ"
}
```

---

## ğŸš€ è¿ç§»æ­¥éª¤

### 1. åç«¯é…ç½®

ç¡®ä¿ `backend/.env` ä¸­æœ‰é«˜å¾·åœ°å›¾ keyï¼š

```bash
AMAP_API_KEY=your_amap_api_key
```

### 2. å‰ç«¯é…ç½®

**åˆ é™¤**å‰ç«¯çš„é«˜å¾·åœ°å›¾é…ç½®ï¼š

```bash
# frontend/.env ä¸­åˆ é™¤ä»¥ä¸‹å†…å®¹
# VITE_AMAP_KEY=...
# VITE_AMAP_SECURITY_CODE=...
```

ç°åœ¨å‰ç«¯**åªéœ€è¦**ï¼š

```bash
VITE_API_BASE_URL=http://localhost:8000/api/v1
```

### 3. å®‰è£…æ–°ä¾èµ–

```bash
# å‰ç«¯
cd frontend
npm install

# åç«¯ï¼ˆhttpx å·²åŒ…å«åœ¨ requirements.txtï¼‰
cd backend
pip install -r requirements.txt
```

### 4. é‡å¯æœåŠ¡

```bash
# åç«¯
cd backend
python main.py

# å‰ç«¯
cd frontend
npm run dev
```

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | ä¹‹å‰ï¼ˆé«˜å¾·å‰ç«¯ï¼‰ | ç°åœ¨ï¼ˆå¼€æº + åç«¯ä»£ç†ï¼‰ |
|------|-----------------|----------------------|
| åœ°å›¾æ˜¾ç¤º | âŒ éœ€è¦é«˜å¾· key | âœ… OpenStreetMap å…è´¹ |
| æ ‡è®°æ™¯ç‚¹ | âœ… | âœ… |
| ç»˜åˆ¶è·¯çº¿ | âœ… | âœ… |
| åœ°ç†ç¼–ç  | âŒ å‰ç«¯è°ƒç”¨ | âœ… åç«¯ä»£ç† |
| POI æœç´¢ | âŒ ä¸æ”¯æŒ | âœ… åç«¯ä»£ç† |
| API key å®‰å…¨ | âŒ æš´éœ²åœ¨å‰ç«¯ | âœ… åªåœ¨åç«¯ |
| æˆæœ¬ | é«˜å¾·æ”¶è´¹ | OSM å…è´¹ + é«˜å¾·æŒ‰éœ€ |

---

## ğŸŒ ä¸ºä»€ä¹ˆé€‰æ‹© OpenStreetMapï¼Ÿ

1. **å®Œå…¨å…è´¹**ï¼šæ— éœ€æ³¨å†Œï¼Œæ— ä½¿ç”¨é™åˆ¶
2. **æ— éœ€ API key**ï¼šä¸ç”¨æ‹…å¿ƒ key æ³„éœ²
3. **å¼€æºç¤¾åŒº**ï¼šå…¨çƒå¿—æ„¿è€…ç»´æŠ¤ï¼Œæ•°æ®ä¸°å¯Œ
4. **æ€§èƒ½ä¼˜ç§€**ï¼šCDN åˆ†å‘ï¼ŒåŠ è½½é€Ÿåº¦å¿«
5. **å¯è‡ªå®šä¹‰**ï¼šå¯ä»¥æ¢ç”¨å…¶ä»–ç“¦ç‰‡æœåŠ¡å•†

---

## ğŸ”„ æ›¿ä»£ç“¦ç‰‡æœåŠ¡

å¦‚æœ OpenStreetMap åœ¨ä¸­å›½è®¿é—®è¾ƒæ…¢ï¼Œå¯ä»¥æ¢ç”¨å…¶ä»–æœåŠ¡ï¼š

### 1. OpenStreetMap ä¸­å›½é•œåƒ

```tsx
<TileLayer
  url="https://tiles.openstreetmap.cn/{z}/{x}/{y}.png"
/>
```

### 2. CartoDBï¼ˆæš—è‰²ä¸»é¢˜ï¼‰

```tsx
<TileLayer
  url="https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"
/>
```

### 3. Stamen Terrainï¼ˆåœ°å½¢å›¾ï¼‰

```tsx
<TileLayer
  url="https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.png"
/>
```

---

## ğŸ“ æ€»ç»“

âœ… **å‰ç«¯**ï¼š
- ç§»é™¤æ‰€æœ‰é«˜å¾·åœ°å›¾é…ç½®
- ä½¿ç”¨ Leaflet + OpenStreetMap æ˜¾ç¤ºåœ°å›¾
- éœ€è¦é«˜å¾·æœåŠ¡æ—¶è°ƒç”¨åç«¯ API

âœ… **åç«¯**ï¼š
- é«˜å¾· API key å®‰å…¨å­˜å‚¨åœ¨ `.env`
- æä¾›åœ°å›¾æœåŠ¡çš„ä»£ç† API
- å¯ä»¥æ·»åŠ æƒé™æ§åˆ¶ã€é¢‘ç‡é™åˆ¶ã€æ—¥å¿—è®°å½•

âœ… **å®‰å…¨æ€§**ï¼š
- æ‰€æœ‰æ•æ„Ÿ API key éƒ½åœ¨åç«¯
- å‰ç«¯åªéœ€è¦åç«¯ API åœ°å€
- å¯ä»¥åœ¨åç«¯æ§åˆ¶æ‰€æœ‰è°ƒç”¨

ğŸ‰ **ç°åœ¨ä½ çš„åº”ç”¨æ›´å®‰å…¨ã€æ›´çµæ´»ã€æˆæœ¬æ›´ä½ï¼**

